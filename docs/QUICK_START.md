# 🚀 快速使用指南

## 一键启动（推荐）

```bash
# 1. 将文档放到 data/ 目录
cp ~/Downloads/your_document.pdf data/

# 2. 运行启动脚本
bash start.sh
```

脚本会自动：
- ✅ 检查文档
- ✅ 导入并向量化文档
- ✅ 启动交互式聊天

---

## 分步执行

### 步骤 1：放置文档

```bash
cp ~/Downloads/your_document.pdf data/
```

支持格式：
- ✅ PDF (.pdf)
- ✅ TXT (.txt)
- ✅ Markdown (.md)
- ✅ EPUB (.epub)

### 步骤 2：导入文档

```bash
python scripts/ingest.py
```

这一步会：
- 📚 加载 data/ 目录下的所有文档
- ✂️ 文本切片（每块 1000 字符）
- 🔢 向量化（使用 text-embedding-v3）
- 💾 存储到 vector_store/ 目录

**注意**：只需执行一次，除非更新了文档。

### 步骤 3：开始提问

**交互式聊天**

```bash
python scripts/chat.py
```

然后直接输入问题：
```
💬 你的问题：什么是协程？
⏳ 正在思考...

🤖 回答：
----------------------------------------------------------------------
协程是一种轻量级的并发编程方式...
----------------------------------------------------------------------

📊 数据来源：✅ 本地知识库
📄 检索到的文档数量：3

📚 引用的文档：
  [1] data/深入理解Kotlin协程.pdf (页码: 68)
  [2] data/深入理解Kotlin协程.pdf (页码: 123)

======================================================================

💬 你的问题：
```

输入 `exit` 退出。

**单次提问**

```bash
python scripts/chat.py "什么是协程？"
```

---

## 更新文档

```bash
# 方式 1：使用启动脚本（会询问是否重新导入）
bash start.sh

# 方式 2：手动重新导入
rm -rf vector_store/          # 删除旧数据库（可选）
python scripts/ingest.py      # 重新导入
python scripts/chat.py        # 开始提问
```

---

## 常用命令

| 命令 | 说明 |
|------|------|
| `bash start.sh` | 一键启动 |
| `python scripts/ingest.py` | 导入文档 |
| `python scripts/chat.py` | 交互式聊天 |
| `python scripts/chat.py "问题"` | 单次提问 |
| `rm -rf vector_store/` | 清空知识库 |

---

## 数据来源说明

每次回答都会显示：

✅ **本地知识库**
- 从你导入的文档中检索
- 显示文档来源和页码
- 显示检索到的文档数量

❌ **模型通用知识**
- 使用通义千问的通用知识
- 文档中没有相关内容时使用

---

## 示例对话

```bash
$ python scripts/chat.py

======================================================================
🤖 AI Agent 知识库问答系统
======================================================================

💡 提示：
  - 直接输入问题，按回车获得答案
  - 输入 'exit' 或 'quit' 退出
  - 输入 'clear' 清屏

======================================================================

⏳ 正在初始化...
✅ 初始化成功！

💬 你的问题：什么是协程？

⏳ 正在思考...

🤖 回答：
----------------------------------------------------------------------
协程是一种轻量级的并发编程方式...
----------------------------------------------------------------------

📊 数据来源：✅ 本地知识库
📄 检索到的文档数量：3

📚 引用的文档：
  [1] data/深入理解Kotlin协程.pdf (页码: 123)
  [2] data/深入理解Kotlin协程.pdf (页码: 68)

======================================================================

💬 你的问题：exit

👋 再见！
```

---

## 故障排查

### 问题：初始化失败

**解决方案**：
```bash
# 1. 检查是否有文档
ls data/

# 2. 导入文档
python scripts/ingest.py

# 3. 检查 .env 配置
cat .env
```

### 问题：回答总是使用模型通用知识

**解决方案**：
```bash
# 重新导入文档
rm -rf vector_store/
python scripts/ingest.py
```

---

## API 服务

如果需要 HTTP API：

```bash
venv/bin/python3.13 -m uvicorn app.main:app --reload
```

访问：http://127.0.0.1:8000/chat?query=你的问题

---

## 费用说明

- **导入文档**：按文档大小计费（text-embedding-v3）
- **每次提问**：按 Token 计费（qwen-plus）

查看费用：https://usercenter.console.aliyun.com/#/expense/overview
