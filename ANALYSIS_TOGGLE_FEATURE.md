# 分析过程开关功能

## 功能说明

新增了一个"显示分析过程"开关，让用户可以选择是否查看答案的详细分析过程。

## 使用方法

1. **位置**：开关位于输入框上方，书籍筛选器的右侧
2. **默认状态**：开启（显示分析过程）
3. **切换方式**：点击开关即可切换

## 开关效果

### 开启时（默认）
显示完整的分析信息：
- 💡 答案来源说明（知识库 + LLM）
- ⚙️ 详细处理流程（可展开查看）
  - 本地知识库检索状态
  - LLM 分析生成
  - 关键词增强（如果命中）
  - Few-Shot 格式化（如果启用）
  - 多轮对话上下文（如果续问）
- 📚 引用来源（可展开查看原文）

### 关闭时
只显示：
- 答案内容
- ⏱️ 耗时
- 🔄 重新生成按钮
- 📋 复制答案按钮

## 适用场景

### 建议开启
- 学习研究：想了解 AI 如何分析问题
- 验证准确性：需要查看引用来源
- 调试优化：开发者调试系统

### 建议关闭
- 快速查询：只需要答案，不关心过程
- 简洁体验：喜欢干净的界面
- 移动设备：屏幕空间有限

## 技术实现

- 前端通过 `showAnalysisToggle` checkbox 控制
- 在 `finalizeAnswerBubble()` 函数中根据开关状态决定是否渲染分析信息
- 使用 CSS 实现美观的切换开关样式
- 开关状态实时生效，无需刷新页面

## 示例对比

**开启时**：
```
💡 答案来源：📚 基于本地知识库（检索到 5 个相关片段）+ 🤖 LLM 分析整合
⚙️ 查看详细处理流程 ▼
[答案内容]
📚 引用来源 (5)：
  - 文档：红楼梦 页码：12 [展开]
⏱️ 耗时 2.34 秒
```

**关闭时**：
```
[答案内容]
⏱️ 耗时 2.34 秒
```

## 更新日期
2026-02-02
